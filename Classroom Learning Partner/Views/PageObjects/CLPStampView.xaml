<catel:UserControl x:Class="Classroom_Learning_Partner.Views.PageObjects.CLPStampView"
                   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
				   xmlns:catel="http://catel.codeplex.com"
                   xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
                   xmlns:vmpo="clr-namespace:Classroom_Learning_Partner.ViewModels.PageObjects"
                   xmlns:vwpo="clr-namespace:Classroom_Learning_Partner.Views.PageObjects"
                   xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                   xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                   mc:Ignorable="d" 
                   d:DesignHeight="300" d:DesignWidth="300">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Thumb>
            <Thumb.Template>
                <ControlTemplate>
                    <Polygon x:Name="PageObjectHitBox" Grid.Row="0" Width="{Binding Width}" MinWidth="50"  Height="50" Stretch="Fill"
                              Stroke="Black" StrokeThickness="0" Fill="Black"
                              Points="0,0 3,0 2,1 1,1" HorizontalAlignment="Center" VerticalAlignment="Bottom"  Margin="0">

                    </Polygon>
                </ControlTemplate>
            </Thumb.Template>
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="PreviewMouseDown">
                    <catel:EventToCommand Command="{Binding Path=CopyStampCommand}"/>
                </i:EventTrigger>
                <i:EventTrigger EventName="PreviewMouseUp">
                    <catel:EventToCommand Command="{Binding Path=PlaceStampCommand}"/>
                </i:EventTrigger>
                <i:EventTrigger EventName="DragDelta">
                    <catel:EventToCommand Command="{Binding Path=DragStampCommand}" PassEventArgsToCommand="True"/>
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </Thumb>
        <Border Grid.Row="1" Width="{Binding Width, Mode=TwoWay}" Height="{Binding InternalPageObject.Height, Mode=TwoWay}" VerticalAlignment="Top" BorderBrush="Black" BorderThickness="2" Margin="0">
            <!-- Control that dynamically determines what PageObject to show -->
            <ContentControl IsHitTestVisible="True" x:Name="PageObjectView" Height="{Binding Path=InternalPageObject.Height, Mode=TwoWay}" Width="{Binding Path=Width, Mode=TwoWay}">

                <Control.Resources>

                    <ControlTemplate x:Key="CLPImageTemplate">
                        <vwpo:CLPImageView DataContext="{Binding InternalPageObject}" />
                    </ControlTemplate>

                    <ControlTemplate x:Key="CLPShapeTemplate">
                        <vwpo:CLPShapeView DataContext="{Binding InternalPageObject}" />
                    </ControlTemplate>

                    <ControlTemplate x:Key="BlankTemplate">
                        <Rectangle Width="{Binding Width, Mode=TwoWay}" Fill="Transparent" Height="{Binding Height, Mode=TwoWay}"  />
                    </ControlTemplate>

                </Control.Resources>

                <Control.Style>
                    <Style TargetType="{x:Type Control}">
                        <Style.Triggers>

                            <!-- CLPImage trigger -->
                            <DataTrigger Binding="{Binding InternalType}" Value="CLPImage">
                                <Setter Property="Template" Value="{StaticResource CLPImageTemplate}" />
                            </DataTrigger>

                            <!-- CLPShape trigger -->
                            <DataTrigger Binding="{Binding InternalType}" Value="CLPShape">
                                <Setter Property="Template" Value="{StaticResource CLPShapeTemplate}" />
                            </DataTrigger>

                            <!-- Blank trigger -->
                            <DataTrigger Binding="{Binding InternalType}" Value="Blank">
                                <Setter Property="Template" Value="{StaticResource BlankTemplate}" />
                            </DataTrigger>

                        </Style.Triggers>
                    </Style>
                </Control.Style>

            </ContentControl>
        </Border>
    </Grid>

</catel:UserControl>
